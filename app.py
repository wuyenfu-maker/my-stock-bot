import streamlit as st
import pandas as pd
import numpy as np

# 1. ç¶²é åŸºæœ¬è¨­å®š
st.set_page_config(page_title="AI æ™ºé¸æ©Ÿå™¨äºº", layout="wide")

# 2. æ¨¡æ“¬æ•¸æ“š (æ­£å¼ç‡Ÿé‹æ™‚å¯ä¸²æ¥ API)
data = {
    "ç”¢æ¥­": ["åŠå°é«”", "åŠå°é«”", "èˆªé‹", "èˆªé‹", "é‡é›»", "AIä¼ºæœå™¨"],
    "è‚¡ç¥¨åç¨±": ["å°ç©é›»", "è¯ç™¼ç§‘", "é•·æ¦®", "é™½æ˜", "ä¸­èˆˆé›»", "å»£é”"],
    "è‚¡åƒ¹": [600, 1100, 155, 50, 120, 240],
    "åˆ¸å•†è²·è³£è¶…(å¼µ)": [1200, -300, 800, -120, 500, 1500],
    "åº«å­˜è®Šå‹•(%)": [1.5, -0.2, 2.1, -0.5, 3.2, 4.5],
    "æ–°èæƒ…ç·’æŒ‡æ¨™": ["åˆ©å¤š", "ä¸­ç«‹", "åˆ©ç©º", "ä¸­ç«‹", "æ¥µæœ‰åˆ©", "åˆ©å¤š"]
}
df = pd.DataFrame(data)

# --- ç¶²é ä»‹é¢é–‹å§‹ ---
st.title("ğŸ“ˆ AI ç”¢æ¥­ç±Œç¢¼é¸è‚¡æ©Ÿå™¨äºº")
st.markdown("---")

# 3. å´é‚Šæ¬„ï¼šåŠŸèƒ½é¸æ“‡
st.sidebar.header("ğŸ” ç¯©é¸æ¢ä»¶")
selected_sector = st.sidebar.selectbox("é¸æ“‡é—œæ³¨ç”¢æ¥­", ["å…¨éƒ¨"] + list(df["ç”¢æ¥­"].unique()))
market_trend = st.sidebar.radio("ç•¶å‰å¤§ç›¤èµ°å‹¢", ["å¤šé ­ (ç«™åœ¨å‡ç·šä¸Š)", "ç©ºé ­ (è·Œç ´å‡ç·š)"])

# 4. é ‚éƒ¨çœ‹æ¿ï¼šå¤§ç›¤æ‘˜è¦
col1, col2, col3 = st.columns(3)
with col1:
    st.metric("å¤§ç›¤ç‹€æ…‹", "åå¤š" if market_trend == "å¤šé ­ (ç«™åœ¨å‡ç·šä¸Š)" else "è­¦ç¤º", delta="ç©©å®š" if market_trend == "å¤šé ­ (ç«™åœ¨å‡ç·šä¸Š)" else "-150")
with col2:
    st.metric("ä¸»åŠ›å‹•å‘", "é›†çµä¸­", delta="5,432 è¬")
with col3:
    st.metric("AI æ¨è–¦ä¿¡å¿ƒ", "85%")

# 5. ä¸»å…§å®¹å€ï¼šç”¢æ¥­å€‹è‚¡åˆ†æ
st.subheader(f"ğŸ“Š {selected_sector} ç”¢æ¥­å³æ™‚åˆ†æ")

# ç¯©é¸é‚è¼¯
display_df = df if selected_sector == "å…¨éƒ¨" else df[df["ç”¢æ¥­"] == selected_sector]

# å‘ˆç¾è¡¨æ ¼ (åŠ ä¸Šé¡è‰²æ¨™ç±¤)
def color_sentiment(val):
    color = 'red' if val == 'åˆ©å¤š' or val == 'æ¥µæœ‰åˆ©' else ('green' if val == 'åˆ©ç©º' else 'white')
    return f'color: {color}'

st.dataframe(display_df.style.applymap(color_sentiment, subset=['æ–°èæƒ…ç·’æŒ‡æ¨™']))

# 6. AI æ·±åº¦è§£è®€å€
st.markdown("---")
st.subheader("ğŸ’¡ AI æŠ•è³‡æ±ºç­–å»ºè­°")

# æ¨¡æ“¬ AI é‚è¼¯åˆ¤æ–·
if market_trend == "å¤šé ­ (ç«™åœ¨å‡ç·šä¸Š)":
    st.success("âœ… **ç•¶å‰ç’°å¢ƒï¼š** å¤§ç›¤å¼·å‹¢ï¼Œå»ºè­°é—œæ³¨ã€Œåˆ¸å•†è²·è¶…ã€ä¸”ã€Œæ–°èæƒ…ç·’åˆ©å¤šã€çš„è‚¡ç¥¨ã€‚")
else:
    st.warning("âš ï¸ **ç•¶å‰ç’°å¢ƒï¼š** å¤§ç›¤å¼±å‹¢ï¼Œå»ºè­°ç¸®æ¸›éƒ¨ä½ï¼Œåƒ…é—œæ³¨ç±Œç¢¼é«˜åº¦é›†ä¸­çš„é˜²ç¦¦å‹å€‹è‚¡ã€‚")

# å‡è¨­é‡å°é¸ä¸­ç¬¬ä¸€ç­†çš„ AI é»è©•
target = display_df.iloc[0]
st.info(f"**AI å° {target['è‚¡ç¥¨åç¨±']} çš„è©•åƒ¹ï¼š** è©²è‚¡åˆ¸å•†åº«å­˜æŒçºŒå¢åŠ  {target['åº«å­˜è®Šå‹•(%)']}%ï¼Œä¸”æ™‚äº‹æ–°èé¡¯ç¤ºå…¶ç”¢æ¥­å‰æ™¯ä½³ï¼Œå»ºè­°åˆ†æ‰¹ä½ˆå±€ã€‚")

# 7. ç±Œç¢¼è¦–è¦ºåŒ–
st.bar_chart(display_df.set_index("è‚¡ç¥¨åç¨±")["åˆ¸å•†è²·è³£è¶…(å¼µ)"])
